{% extends "layout.html" %}

{% block page_script %}
<script>
    console.log("Script running");
    document.addEventListener("turbo:load" , () => {
        // This might setup a race condition, if the first poll response 
        // arrives before the listen
        console.log("Listener Starting");
        fetch("/poll/listen", {method: "POST"});
        eventContainer = document.getElementById("message-container");
        poller(2, eventContainer);
    });
</script>
{% endblock %}

{% block contents %}
<div>
    <h1 class="title">Submitted {{active_log}} logs</h2>
    <details class="message eh-message">
        <summary class="message-header">
            <span>Submitted Logs</span>
            <span>{{time}}</span>
        </summary>
        <pre class="message-body">{{log_text}}</pre>
    </details>
    <div id="message-container">
    </div>
</div>
{% endblock %}